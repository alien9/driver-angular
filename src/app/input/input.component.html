
<div class="container">
    <h2>New Record</h2>
<form action="/action_page.php">
    <div class="form-group" [formGroup]="date">
        <mat-form-field>
            <mat-label>Choose a date</mat-label>
            <input matInput [matDatepicker]="picker" formControlName="date">
            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
            <mat-datepicker #picker></mat-datepicker>
          </mat-form-field>
    </div>
    <div class="form-group" [formGroup]="time">
        <mat-label>Choose a time</mat-label>
        <input [ngxTimepicker]="timepicker" class="form-control" formControlName="time"> 
        <ngx-material-timepicker #timepicker></ngx-material-timepicker>
    </div>

<div  *ngFor="let table of tables"  class="{{table}}">
    <button (click)="add(table)" *ngIf="schema['definitions'][table].multiple" class="add">+</button>
    <h3>{{schema['definitions'][table].title}}</h3>
    <div class="item" *ngIf="!schema['definitions'][table].multiple">
        <div *ngFor="let field of schema['definitions'][table].fields">
            <div class="form-group" *ngIf="field.fieldType=='text'">
                <mat-label>{{field.key}}</mat-label>
                <input name="{{field.key}}"  class="form-control" />
            </div>
            <div class="form-group selectable" *ngIf="field.fieldType=='selectlist'" id="{{field.key}}">
                <mat-label>{{field.key}}</mat-label>
                <mat-select *ngIf="field.format!='checkbox'">
                <mat-option *ngFor="let item of field.enum" value="item">{{item}}</mat-option>
                </mat-select>
                <mat-select *ngIf="field.format=='checkbox'" multiple>
                <mat-option *ngFor="let item of field.items.enum" value="item">{{item}}</mat-option>
                </mat-select>
            </div>
        </div>
    </div>
    <div *ngIf="schema['definitions'][table].multiple">
        <div *ngFor="let u of registry.data[table]; let i = index" class="item">
            <input name="_LocalId" type="hidden" [(ngModel)]="u._LocalId" />
            <div *ngFor="let field of schema['definitions'][table].fields">
                <div class="form-group" *ngIf="field.fieldType=='text'">
                    <mat-label>{{field.key}}</mat-label>
                    <input name="{{field.key}}"  class="form-control" />
                </div>
                <div class="form-group selectable" *ngIf="field.fieldType=='selectlist'" id="{{field.key}}">
                    <mat-label>{{field.key}}</mat-label>
                    <mat-select *ngIf="field.format!='checkbox'"  [(ngModel)]="u[field.key]"  name="{{field.key}}">
                    <mat-option *ngFor="let item of field.enum" [value]="item">{{item}}</mat-option>
                    </mat-select>
                    <mat-select *ngIf="field.format=='checkbox'" multiple [(ngModel)]="u[field.key]" name="{{field.key}}">
                    <mat-option *ngFor="let item of field.items.enum" [value]="item">{{item}}</mat-option>
                    </mat-select>
                </div>
                <div class="form-group selectable" *ngIf="field.fieldType=='reference'" id="{{field.key}}">
                    <mat-label>{{field.key}}</mat-label>
                    <mat-select [(ngModel)]="u[field.key]" name="{{field.key}}">
                        <mat-option *ngFor="let item of registry.data[field.watch.target]; let v=index" [value]="item._LocalId">{{1+v}}</mat-option>
                    </mat-select>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="form-group">
    <input class="btn btn-primary"  type="file" accept="image/*" capture="environment">
</div>
<div class="form-group">
    <button class="btn btn-primary"  value="OK" (click)="write()">OK</button>
    &nbsp;
    <button class="btn btn-primary" value="Cancel" (click)="cancel()">Cancel</button>
</div>
</form>
</div>
